<% color = { "pending" => "bg-warning", "awaiting" => "bg-warning", "confirmed" => "bg-success", "canceled" => "bg-danger" } %>

<div class="container d-flex justify-content-center mb-5">
  <div>
    
    <% if company_signed_in? && @duplicated_booking_dates.any? %>
      <div class="container border mb-2">
        <p class="text-danger mb-1"><%= "Já existe um ou mais pedidos requeridos para esta data (#{l(@order.booking_date)}):" %></p>
        <ul>
          <% @duplicated_booking_dates.each do |order| %>
            <li><p><%= "Pedido: #{order.code} - #{order.event_pricing.event.name}" %></p></li>
          <% end %>
        </ul>
      </div>
    <% end %>
    
    <div class="rounded shadow px-5 pb-3 pt-3">
      <div class="container text-center mb-3">
        <span class="<%= "rounded p-1 #{color[@order.status]}" %>"><strong><%= t(@order.status) %></strong></span>
      </div>
      <h3>Código do pedido: <%= @order.code %></h3>
      <hr>
      <p><strong>Buffet: </strong><%= @order.company.buffet_name %></p>
      <p><strong>Evento: </strong><%= @order.event_pricing.event.name %></p>
      <p><strong>Número de convidados: </strong><%= @order.predicted_guests %></p>
      <p><strong>Data do evento: </strong><%= l(@order.booking_date) %></p>
      <p><strong>Local do evento: </strong><%= @order.event_adress %></p>
      <p><strong>Detalhes do evento: </strong><%= @order.event_details %></p>
      
      <% if company_signed_in? && @order.budget.blank? %>
        <%= link_to 'Criar orçamento', new_order_budget_path(order_id: @order.id), class: "btn btn-dark pt-2" %>
      <% end %>
      <hr>

      <% if @order.budget.present? %>
        <div>
          <h5>Orçamento proposto:</h5>
          <p><strong>Preço base para <%= @order.predicted_guests %> convidados: </strong><%= number_to_currency @order.budget.base_price %></p>
          
          <% if @order.budget.additional_cost > 0 %>
            <p><strong>Taxa extra: </strong><%= number_to_currency @order.budget.additional_cost %></p>
            <p><strong>Razão da taxa extra: </strong><%= @order.budget.additional_cost_describe %></p>
          <% end %>
          
          <% if @order.budget.discount > 0 %>
            <p><strong>Desconto: </strong><%= number_to_currency @order.budget.discount %></p>
            <p><strong>Razão do desconto: </strong><%= @order.budget.discount_describe %></p>
          <% end %>
          <p><strong>Forma de pagamento: </strong><%= @order.budget.payment_method.method %></p>
          <strong>Total: <%= number_to_currency @order.budget.final_price %></strong>

          <% if client_signed_in? && @order.status == "pending" %>
           
          <% end %>
          
          <hr>
        </div>
      <% end %>
    </div>
  </div>
</div>

